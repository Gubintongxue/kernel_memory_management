【Linux 内核 内存管理】分区伙伴分配器 ④ ( 备用内存区域列表排序方式 | 节点优先顺序 | 区域优先顺序 | 排序方式优缺点 | 默认排序方式 )

#### 文章目录

-   [一、备用内存区域列表排序方式 ( 节点优先顺序 | 区域优先顺序 )](https://cloud.tencent.com/developer?from_column=20421&from=20421)
-   [二、备用内存区域列表排序方式优缺点 ( 节点优先顺序 | 区域优先顺序 )](https://cloud.tencent.com/developer?from_column=20421&from=20421)
-   [三、备用内存区域列表默认排序方式](https://cloud.tencent.com/developer?from_column=20421&from=20421)

在上一篇博客 [【Linux 内核 内存管理】分区伙伴分配器 ③ ( 备用内存区域列表 | ZONELIST\_FALLBACK 枚举 | zoneref 结构体 | 备用内存区域借用物理页规则 )](https://cloud.tencent.com/developer/tools/blog-entry?target=https%3A%2F%2Fhanshuliang.blog.csdn.net%2Farticle%2Fdetails%2F124342397%3Fspm%3D1001.2014.3001.5502&source=article&objectId=2253542) 中 , 介绍了 UMA 系统的 备用内存区域列表 :

UMA 系统的 每个 内存节点 中 , 都有

22

个 备用内存区域列表 ,

① 一个包含了 所有内存节点 的 备用内存区域列表 ,

② 另外一个 包含了 当前内存节点 的 备用区域列表 ;

## 一、备用内存区域列表排序方式 ( 节点优先顺序 | 区域优先顺序 )

* * *

包含了 所有内存节点 的 备用内存区域列表 , 有

22

种排序方式 :

**① 节点优先顺序 :** 先 根据 " 节点距离 “ 由远到近 进行排序 , 然后根据 ” 区域类型 " 由高到低 进行排序 ;

**② 区域优先顺序 :** 先 根据 " 区域类型 " 由高到低 进行排序 , 然后 根据 " 节点距离 " 由远到近 进行排序 ;

## 二、备用内存区域列表排序方式优缺点 ( 节点优先顺序 | 区域优先顺序 )

* * *

**理想的情况应该是 既选择 距离较近的内存 , 又能减少 低区域类型内存 耗尽的概率 ;**

**① 节点优先顺序 :** 该排序可以 优先 选择 距离较近 的内存 , 但是可能会在 高区域类型内存 耗尽前 使用 低区域类型内存 ;

**② 区域优先顺序 :** 该排序 减少 低区域类型内存 耗尽的概率 , 但是不能保证选择的内存距离最近 ;

## 三、备用内存区域列表默认排序方式

* * *

**默认排序方法 :** 系统会自动选择 最优 排序策略 ;

6464

**位系统** 需要用到的 DMA 和 DMA32 类型区域较少 , 选择 " 节点优先顺序 " ;

3232

**位系统** 选择 " 区域优先顺序 " ;

## 参考

[【Linux 内核 内存管理】分区伙伴分配器 ④ ( 备用内存区域列表排序方式 | 节点优先顺序 | 区域优先顺序 | 排序方式优缺点 | 默认排序方式 )-腾讯云开发者社区-腾讯云 (tencent.com)](https://cloud.tencent.com/developer/article/2253542)