好的那首先欢迎各位朋友们来到铃声交易啊
我是威克
这节课啊
主要是给大家分享一下企业机制的一个讲解
本节课呢我们再讲啊四个核心技术点
那首先我们来看第一个问题啊
业故障产生其错误的定位
那首先我们知道LINUX内核啊要注意一点
那么他这个内核当中的一个什么呢
就是我们经常讲的这个什么液故障业障
还有地方叫什么page flat是吧
就这个意思啊
那么它具体是什么意思呢
它就是指什么
就是当这个程序啊
是指少了一个字啊
是指当什么呢
当程序它访问一个什么
访问一个就是相当于什么呢
尚未映射到什么物理内存的一个什么虚拟页面
虚拟页面的时候
那么它就发生了一个什么
发生了一个异常情况好
那么这个常见的业故障
那它又包含什么呢
包含这个啊这个缺页错误啊
切页错误是不是
所以就是说我需要那个页面
就是你所要那个页面
它不在物理内存当中
那么这个时候你需要什么
你需要置换
就这个意思
你需要释放的话呢
还包括什么
这是一个点啊
要注意另外一个是什么呢
比如写保护错误了
他还有一种是写保护错误
写保护错误是什么意思啊
就是writer protection flat
就是写就是写写保护错误
那么写保护错误的话
就是你要尝试啊
试图写入只读页面
或者是说你非法操作错误
它都会导致一个什么呢
一夜故障请求
那么就是说当什么呢
另外一个问题就是当当我们发现这个液故障
要注意啊
他们发现这个液页故障的时候
那么我们通过什么
就是你这个LINUX内核对不对
他就通过什么通过处理机制嗯
通过处理机制来解决这个问题
那怎么去解决呢
第一个啊
第一个问题具体的办法
那么可能就是D你叫内存检测到什么
到一页故障
就这个意思
内核检测到异故障
什么意思
就是说并且这个时候啊你要干什么呀
这个流程啊
他的这个解决的这个流程要搞清楚解决流程
第一个就是我们所讲的一个一页故障是吧
内核检测到液故障
那么你要将什么
你要将这个控制权把它转移到相应的一个
异常处理函数
就这个意思啊
这是我们处理的一个点好
另外另外一个的话呢就是相当于第二个了
第二个是什么呢
就是说异常处理函数嗯
他会就会什么
就会根据你导致这一个什么
导致这个液故障的原因
我们可以什么进行相应的处理哎
就这个意思
那上面这个再加上啊
并且那我们要将什么将控制权把它转移到什么
相应的一个什么相应的异常处理函数
就这个意思
这是第二个点啊
这个流程啊
第三个是什么呢
第三个是这样的
如果什么呢
如果是缺页啊
要注意啊
如果是这个嗯
如果是切页错误
那么内核呢它就会怎么样呢
就会尝试啊
尝试从我们磁盘上面来加载一个相应的一个
什么页面
到什么呢
到物理内存当中
就这个意思
然后我们这时候就要更新什么
更新对应的一个什么数据结构
这就是第三个点
那么第四个点是什么呢
就是一旦什么第四个方啊
第四步啊
就是一旦啊这个缺月啊
要注意啊
一旦缺页错误
他得到什么呢
得到解决了
这个时候你控制权呢你就要返回给什么呢
返回给引起什么
返回给引起这个异常的一个什么指令啊
那么注意这个指令呢他就需要什么呢
需要重新去执行
就是你按照这个流程来就行
就说总体来讲LINUX内核这个液故障呢
它是一种正常必要的一种机制
那么用于什么呢
管理我们虚拟地址和物理地址之间的
一个什么映射关系
那么它还可以什么来保护一些有效的一个
什么系统资源
这是我们从这个角度上来看好
那么另外一个的话呢
我们来看啊
第二个就是嗯我们如何定位
下面我们看一下如何定位
是不是一般情况下刚才已经讲了啊
我们所讲的一个什么呢
就是在内核当中啊
就是当进程他访问一个没有映射这个
物理内存的一个虚拟地址的时候
就发现这个缺异常
对不对
缺异常刚才讲了啊
你看一下给备注一下
来我们备注一下备注什么
备注一下这个页故障业故障有哪些呢
第一个是保护异常
这是一方面
另外一方面呢啊就是这个契约异常
还有一方面就是什么写实复制异常
总共是三种
总共三种
那么这三种的话
刚才讲了这个保护异常
就是你访问被禁止那个页面的权限
如果只读页面进行写保护等等
第二个就是缺一异常
安缺页异常的话
就是你这个页面没有加载的物理内存
你需要从磁盘或者从那个交换空间进行加载
就这么个意思啊
这个写实复制异常就是什么写实写实写错了啊
不好意思
写实写时复制异常
就是你多个进程共享同一个页面
那么其中一个进程呢
尝试在那个页面进行写操作
所要写的复制异常
所以这个思路啊大家一定要打开是不是好
那现在的话呢我们这个啊打开之后
那么接下来我们就来看第二个了
第二个就是什么呢
要告诉大家这个什么
我们如何定位啊
因为这个业故障啊和什么呢
以及它的一个错误
对不对
定位业务赚取错误的话
那么具体的一个步骤啊
我们按这个来走啊
第一步我们要什么呢
要查看这个错误消息
什么意思
大家看一下诶
查看错误消息怎么做呢
那就是说LINUX内核我们通常是会什么呢
就是会用那个打印
打印出跟那个页面故页故障的错误信息
比如啊嗯一般情况下在这里的话
我们可以用什么呢
你比如你要检查一下
来检查什么呢
你检查系统日志
系统日志是什么
VR杠什么log m1message
这个也可以啊
这是一个方法啊
或者我们就使用什么来使用这个d message啊
这个命令来获取什么
来获取一个详细信息
这是一方面
第二个我们就使用什么呢
通过这个工具来分析工具
分析什么呢
我们可以用这个什么GDP啊啊
还有什么s trans是吧
以及什么呢
puff啊
通过这些进行了跟踪
通过他们来跟踪和调试那个程序的执行过程
就这个意思是吧
所以说这些工具它就能够帮助我们啊
来分析和普通那个业故障发生的一个堆栈
跟踪信息
还包括什么寄存器状态啊
还有这个其他调试信息啊
这些都可以搞定
所以你要知道
那么第三个步骤的话呢
我们就要什么呢
你就要检查一下这个内存管理机制
这个时候
我们为什么要检查这个内存管理机制啊
这个原因非常简单啊
各位同学们是吧
好边上班边听课是吧
还要好好啊
嗯那么这个检查内存管理机制
这个的话是什么意思呢
就LINUX内核的一个什么呢
比如他整个内存管理系统
内存管理系统干什么呢
他就专门负责我们这个处理啊
这个业故障啊
虚拟地址到物理地址的一个映射
那么就是说LINUX内存管理机制的工作原理和方法
它可以什么
可以帮助我们更好的去理解
这个业故障发生和什么和对应的一个处理过程
这是我们从这个点
那另外一个就是什么呢
另外第四个了
第四个你就要你就要从哪里分析呢
你要分析这个代码逻辑关系了
对不对
那个代码逻辑关系发电了啊
就是如果啊我们有那个什么呢
如果你有访问那个内核语言代码的权限啊
这个注意啊
分析代码逻辑
就是说哎你有这个啊访问内核源代码的呈现
那我们这时候就可以通过
一步一步的分析这个问题
特别是什么呀
特别有关这个什么这个页面映射啊
还有一个就是分配啊啊释放啊
这些相关的代码关
总体来讲整体来讲啊
就是说你要对于这个月故障的错误定位的话
第一你要结合什么
结合系统日志调试工具
内核源代码进行综合整理分析
嗯这就是我们要搞定的一个点
那么搞定这个之后呢
那么接下来我们就来看下一个问题了是吧
下个问题啊
就是我们本节课的第三点
第三点大家知道一个什么
你必须要知道一个缺页异常
什么意思
缺异常就是加什么呢
在LINUX内核当中
就是我们所讲的个什么缺异常啊
它是一种非常常见的情况
切异常是一种非常常见的一个什么异常情况
那么什么意思呢
就是当这个程序它访问一个什么
访问一个上位映射到什么
映射到物理内存的一个什么虚拟地址时
它就会什么就会给我们触发这个什么
触发缺页异常
就这个意思
那么这个时候啊它可能会什么呢
可能是因为你这个页面没有分配什么
你这个页面没有分配这个啊物理内存
或者是你这个页面已经被交换到磁盘
其他了啊
产生这种原因
那么可能就是缺异常了
对不对
嗯刚才啊我已经告诉大家了
那么就说当我们这个缺页异常啊
一般情况下
那么在面试啊
就是在内核的一个什么技术面试当中
对不对
它就会出现什么会出现哎
当然什么呢
当这个嗯缺页异常发生时
对不对
那这个时候
那么我们这个什么
你操作系统它通常是不是废啊
如何处理
对不对
怎么去解决这个问题啊
这个你得想一下是不是回答这个问题怎么做呢
就是说首先第一个问题
你在回答这些问题的时候
你要想到一个非常简单的一个方法
是不是
那么你想到哪几个点方法来
当前异常发生时
操作系统通常会如何处理
如何解决是吧
嗯第一个操作系统
它会检查那个引发缺页异常的一个虚拟地址
是否有效
并且要对应的一个什么内存映射
这是第一点啊
第一个要干的
第二个的话呢
那如果没有有效的映射
那么操作系统会将什么
将页面分配的一个物理内存
并且建立这个虚拟地址和物理地址之间的
映射关系
第三如果你这个页面已经被什么
已经被交换到磁盘了
那么操作系统将从磁盘中读取这个页面数据
并且加载到物理内存
对不对
那就这么处理了
第四个的话就是操作系统它更新页面的时候
以及反映这个新的一个映射关系
并且要重新什么
重新执行这个引发的一个区异常生
那么通过我们这种方法去处理
那么你这个程序就可以正常执行了
并且你所需要的数据也能够正确的
加载到物理内存
这是从理论理论值上来
我们大家一定要研究的一个点啊
这是缺异常啊
那么第四个第四个是什么呢
第四个就是保护异常
我们再次研究是不是缺一场
刚才讲了还有保护异常算
那么这个保护异常是怎么回事呢
大家可要注意啊
保护无非就是讲究安全问题是吧
保护异常它一般是通常什么呢
通常这个E子啊它主要是指什么呢
指通常这个异常处理机制来保护什么
哎来保护我们这个系统啊
保护系统的一个什么稳定性和安全性
稳定性和安全性什么意思
就是说当这个发生异常情况的时候
对不对
那么比如啊这个内存访问错误
还有一种就是什么呢
非法指令执行操作系统
它以捕获这些异常进行处理
内核就使用一个什么有专门有一个什么
专门有一个异常
就是异常向量表
Expression rate table
他专门有个数据结构来管理这个异常情况
那么这个表当中啊
它就包含了每一个异常对应的处理函数
以及相关的入口地址
就这么个意思啊
就是其实啊他通过这个来管理的就是LINUX内核哎
他就使用一种使用一种什么叫做这个异常向量
嗯异常向量表
异常向量表这个异常向量表数据结构干什么呢
来管理各种异常情况
就这个意思
它本身注意啊
它本身这里面哎他就有一个什么呀
嗯他就有一个有一个什么呢
有一个处理函数
还有一个处理函数的入口地址
他就直接在入口地址里面找
当发生异常的时候
硬件为什么
硬件他就将那个控制前科目权限转移给什么呢
转移给这个异常处理程序进行完成啊
要执行一些相应的保护措施
那么可以什么呢
确保在出现问题的时候
操作系统它能够什么能够及时来响应
采取这个适当措施
防止系统崩溃
或者是有一些恶意攻击
他必须要做到这一点
否则你这个内核不安全
那还搞什么呢
对不对
那么通过这个保护啊
通过这个保护异常机制呢
LINUX内核它就可以什么
提高你整个系统的一个什么安全和可靠性能
也能够保证你那个运行环境正常
尤其LINUX做什么
做服务器的领域里面是不是非常的强大
这就这个点
那么还有一个什么呢
还有一个就是第五点的
第五点的话要注意的是什么
要注意的是我们所讲的一个什么写实复制异常
写时复制异常是什么意思呢
它的原理非常简单
写出一段的CORE是COW
是不是就是说写实复制异常
就是我们所讲的一个什么
它就是内存管理技术嘛
就这个意思是不是原理啊
原理是什么
就是当多个进程来共享什么
共享同一个什么同一个字眼
你比如这个
比如我们经常讲的一个什么内存页的时候
他会怎么样呢
只有什么呢
只有当其中一个进程呢
他要试图什么呢
试图修改使资源的时候才会什么
才会进行实际的一个什么复制操作
为什么呢
主要它还是什么呢
还是确保每一个进程嗯
都能够什么呢
能够获取独立的一个副本
就是方便操作
什么意思
那有关于什么呢
有关于这个写实复制异常啊
那就说我们在什么呢
如果在写实复制过程中出现异常
你比如内存分配失败或者是权限错误
它会导致什么无法执行写操作
就这些问题
就这个问题啊
那么接下来呢
接下来我们就来看本节课当中的第二大点
进程地址空间
还有一个什么缺异常处理
什么意思
大家注意啊
就说你这个区间的话
一般情况下就是你这个LINUX内核是不是注意啊
LINUX内核
LINUX内核中当什么呢
当进程它访问什么
访问一个没有映射到物理内存的
一个什么虚拟地址时
它为什么呢
他直接会触发这个缺异常
做一些异常的话呢
那么这个异常啊
就是该异常的一个什么处理流程
大家必须知道
第一个的话嗯就是要学会什么呢
区域异常的一个什么缺异常的一个触发
那么缺异常触发是什么意思
就是触发就是当进程去访问
没有映射到物理内存的虚拟地址
这个进程的时候
那么CPU它就会产生一条什么缺异常中断信号
这就是缺异常的触发
第二个它就是什么呢
第二步的话就要处理什么LINUX内核中断处理程序
什么意思
这个时候CPU它自然会切换到内核模式
并且呢
把这个控制权限交给相应的一个什么
中断处理程序
那么这里所讲的一个缺页异常处理程序
就这个意思
这是第二部啊
第三要处理什么呢
就是你异常处理程序的一个执行
异常处理程序执行什么
就是你缺异常处理程序
它首先要检查这个虚拟地址是否有效
或者适合什么是否合法
就这个意思
那如果不合法或者是说无效
他就会终止你这个进程
那如果合法有效
就执行下一步操作
就这个意思啊
这是第三步
第四步的话我们就要处理什么这个页面分配好
这位小刘同学啊
讲的好是吧
大家只要认真听啊
因为内核这个技术点相当难度是比较高的是吧
所以综合很多知识来听
有一定的收获
是不是
但是你来到课程里面
大家只要来到课程
你认真去听
还是没有问题的
还是什么问题好
这个页面分配是怎么回事呢
你页面分配之后
你还页面加载了
它就这么一个思路
一路一路走下来
是不是就说你这个页面分配
就是说如果虚拟地址他对那个页面呢
它没有被分配
那么这个缺异常处理程序
就为它分配一个什么物理内存
就这个意思
然后建立一个虚拟地址的
一个什么与物理地址的映射关系
这就是页面的分配
分配完之后
那么这个时候页面要加载什么意思
页面加载
就是说如果这个虚拟地址对应的一个页面
已经被分配了啊
但是还没有从磁盘加载数据
那么缺异常处理程序呢
会通过那个调度器将这个页面所在的一个文件
从磁盘读取这个物理内存
就这个意思是吧
还有一个第六个的话就是更新这个页表
那为什么更新列表
就是你完成页面分配和加载之后
全异常处理程序
那么这时候就必须要什么
必须要更新进程的页表
更新那个先进程列表
将那个虚拟地址跟新分配
或者家长的物理地址进行映射一下
是不是更新完之后
那么接下来就重新执行啊
引起的一个什么来啊
缺页异常的一个指令
它的流程就这么做了
是不是这一步是怎么做的
这不就是说通用程序它会将什么
会将这个控制权交给我们用户进程
然后并且重新执行引发那个缺异常的指令
然后就这样的话
他会访问了
这次的话问就会成功
就是他那个处理方法大家注意啊
OK那么刚才所讲的通过啊
大家通过这七个步骤对不对
LINUX内核它能够什么有效的去处理这个进程啊
这个地址空间的一个缺页异常
也能够保证这个进程
虚拟内存和物理内存之间的一个正确映射
这是本节课的第二大点
那本节课第二大点之后呢
那么接下来什么
接下来我们学本节课的第三点
第三点是什么意思啊
一个是请求调页和写实复制
那现在我们先看第一个是第一个就是请求调页
请求调页
它也是什么呢
也是内存管理当中的一种技术
它能够什么
他允许这个操作系统将是什么呢
将进程部分的一个虚拟地址空间
把它什么呢加载到物理内存中
并且呢它只有什么
只有当进程真正的什么真正需要使用啊
这些页面的时候才进行什么才进行加载
是不是这样的
为什么这么做呢
就是这种就相当于延迟了
对不对
这种什么呢
这种延迟加延迟啊
OK嗯这种延迟加载的方式
延迟加载方式哎他怎么样呢
它可以能够有效的能够减少什么
减少内存占用和什么和这个启动时间啊
这就是调研请求好
第二个就是我们要掌握的一个什么
要掌握的一个写实数字写实复制
刚才讲了它用于什么
比如用于优化共享内存
用于这个优化共享资源的一个什么复制操作
就这个意思了
所以说当什么呢
当多个进程或者是什么或者是线程
它需要什么
需要访问一个资源的时候
那么初始初始他们
初始时他们呢他就共享什么
共享同一个什么同一个副本
对不对
共享团购副本的话
那就是如果什么唉
如果你其中注意啊
如果其中一个进程它叫什么呢
要修改该资源的话
那他就会什么就会直接触发了
触发这个写实复制操作
就这个意思
那么你触发写时复制操作
那么操作系统它就可以创建一个这个资源副本
然后你然后就仅仅是对这个修改操作
进行实际的拷贝
其他进程仍然继续什么呢
继续共享
也有那个副本呢
对不对
这样的话它可以节省内存
内存的开销吗
然后可以什么
还可以提高这个系统的一个什么整体性能
他的方法就是这样做的好
那么这个问题我们解决之后
因为这个东西确实比较难啊
还是需要一定的基础功底
是不是
否则就难以搞定这些问题啊
这是一个点
那么另外一个的话呢
我们要干什么呢
我们要告诉大家本节课的第四点
第四点是什么
内存检测
对不对
那首先你知道LINUX内核它的一个什么内存检测
内存检测方法
那你怎么去检测呢
内存检测方法我们看一下啊
第一种我们就用什么呢
第一种你可以用这个内存泄漏的一个什么
别着急啊
内存泄漏检测工具的第一种
哎那有同学问老师
那内存检测泄漏工具是什么意思啊
那如果大家好
如果大家经常做这个内核研发这一块的话
那么这些工具也非常熟悉了
没有了啊
啊这是其中一种
另外一种是什么呢
还有一种是n scale
N s q l
除了这种以外还有什么呢
还有一种是SKSK是吧
那这些这你要再安装啊
那就是你用到这些工具的时候
对不对
哎就是当你用到这些工具的时候
它自然就会来告诉我们
不告诉我们什么意思呢
非常简单嘛
就说可以帮助我们检查一下程序
这么个内存泄露问题啊
那这些工具能够什么呢
能够跟踪分配和释放内存
并且告诉你没有释放的一个内存块在哪里
是不是非常简单啊
那其实在这个就是一方面
另外一方面的话呢
大家注意你要学会使用什么
我们直接什么呢
就是作为一个开发人员就直接使用这个系统啊
系统自带的一个什么工具
那么自带工具的话
一般情况下我用的比较多
那你就直接在PLC目录下面这些文件
这是一方面
另外一方面的话呢
你可以查看内存相关的PC目录下的杠啊
PLC目录下了MEM就是memory information
这个也可以查看是不是
还有一个就是嗯叫什么对
还有一个就是你要查看那个叫什么叫啊
对
PLC下面装了一个什么这个进程
PID目录下面装了一个什么map
这个地方我们可以干什么呢
这里你可以看到什么
你可以看到那个进程地址空间的运输关系
所以我们在学内科的时候
大家只要跟着我的思路来就可以了
对不对
给你总结好了
是不是哎初试完之后还要学会什么
还要内核这块你要学会调试器
调试器的话就是我们GDP了
是不是嗯
GDP这个调试器
可以帮助我们定位内存的一个相关问题
比如你怎么去通过代码来设置
单点监视某一个变量
什么print是不是访问地址啊等等啊
还可以追踪调试内存工具
什么意思呢
你看啊
大家可以看一下
不要着急
我这里给大家整好了
是不是你看什么意思啊
GDP这个调试工具对不对
他调试程序的时候你怎么做
你不要着急
是不是这样
他的一个什么它的调试技巧
我已经给了这种总结了
比如第一启动
第二你设置端点
第三运行程序
第四单步执行
继续执行
查看变量
只接收变量啊
回溯这个站的一个调用哎
回溯调用那个站还有什么修改这个变量值吗
怎么查看内存是不是
所以说大家一定要注意这个相关问题啊
那这里面的每一个步骤都给你写好了
看到没有
里面的代码
是不是我是不是都给你列好了
今天给大家整的啊
就是维克给你整的啊
你看怎么做
怎么去调试或得到结果
是不是还有f trust的一个调试大全
这个文档我就不再列举
如果需要的话
大家可以找那个秋香老师来搞定就可以了
这就是我们的调试器
那么掌握这个调试器之后还有什么呢
还有一种就是你要学会这个什么静态静态
这个什么静态代码分析工具啊
静态代码分析工具的话
这个比较简单
对不对
哎你可以使用什么来使用这个C加加check cpp check
还有一个什么c on c line
什么TT都来这啊
你可以使用这种这种的话工具
它可以静态分析代码
还可以什么来识别一个潜在的内存问题
他给出警告变成黄色就可以查看得到是不是
所以这些工具啊
就是我们内存检测是不是他这个方法
那我们除了内存检测方法之后
还有一种什么
还有一种就是本节课的下一个点
就是第二点
第二点是什么
就是
嗯第二点
第二点就是LINUX内核
嗯内核的一个什么死锁检测方法
那么他那个检测方法你怎么检测呢
你看啊
第一个问题
无非你要掌握什么及时锁的一个检测算法
这问题怎么去想呢
是不是就说LINUX内核使用什么
它使用的是基于什么基资源分配的
一个一般是采用什么
一般这个死锁检测就采用银行家算法了
一般你这个银行家算法一般是这样啊
嗯银行加算法进行什么来进行死锁检测
这些在操作系统里面讲
在这里的话啊
嗯维克老师就不再给大家一一的进行什么
一的列举了
那么有关于什么呢
有关于银行家实锁算法
那你要做到什么银行价值所算法
它是一种什么避免死锁的非常著名的算法
有没有研究过
是不是它是可以操系统啊
要注意啊
他是避免死锁
算有牵涉的东西可能比较多
是不是避免了它有效直接能够避免
避免
避免你这个死锁是不是就这么写
不好写啊
就是banks of arithm好
这种算法是这样的
还有一种避免算法
如果你看到那个d d a t lock
它也是避免思索的意思
这个就是并联思索
就这个意思啊
注意啊这个单词啊
DAKLOCKD2就不错
dd我写错
不好意思啊
die我写错了是die d AD哎lock
这个是避免思索
刚才我写错了
那么这种的话是非常简单
是不是就是系统设计避免死锁双方它以什么呢
他以这个银行的一个借贷系统分配策略为基础
判断
你保证这个系统的安全性嗯
他就可以看到这一点
是不是
那么如果在座的各位同学们啊
如果大家研究过这个什么
如果大家研究过这个算法的话
那么银行家算法的一个原理是非常简单的
嗯为什么叫银行家算法呢
嗯给大家讲一下是不是吹一吹是吧
什么意思呢
银行加算法我们就把什么
比如你把一个银行把把那个对
你把这个操作系统啊
我们把操作系统看作是一个啊银行加大方
那么操作系统管理这些资源
就相当于银行家管理那些资金
就是管理那个钱啊
那么进程向操作系统请求分配资源
就像什么呢
就相当于像我们啊
在座的各位客户向银行进行贷款
就这个意思
他就这么一个思路啊
这么个思路
那能不能理解啊
嗯他这个意思啦
你看啊他比如那就是比喻什么
它就相当于比喻比喻什么
比喻我们这个操作系统相当于什么
相当于这个银行家
是不是嗯
然后其实银行家就提供什么
就专门提供这个资源进行管理资金的操作系统
操作系统他就管理什么
就是相当于操作系统
哎你就管理资源
操作系统
管理资源
那你就相当于什么
相当于你相当于银行家吗
管理这个资金一样嘛
就这个意思管理这个资金啊
所以进程进程向操作系统请求什么
操作系统请求分配这个资源
那么就相当于
相当于用户对不对
用户像什么呢
像这个啊银行家进行贷款
是不是
所以你你按照这个思路来来想的话
那么这个实时检测算法
有关银行家的算法就很容易理解了
OK好
什么意思呢
他电脑当一个顾客对资金
它的最大需求量不能超过这个银行家
现有那个资金的时候
那么就可以接纳那个顾客
是不是
那顾客呢他也可以分期贷款啊
那么但是贷款总数不能超过最大的需求量
就这个意思
那么当这个银行家啊
现有资金你不能满足顾客啊这个需求
贷款数额的时候
那么对顾客贷款他就可以推迟支付
是不是
但你总总能够使那个客人
有限的时间取到这个贷款
他可以分期贷给你
定期我带给你2000万
是不是
第二期再给你5000万
是不是总总是我不不少你的是不是
但是现在没那么多
就得分分分批给你
是不是
就是当这个顾客
他得到他自己所需要所有资金的之后
那么一定在有限的时间内
他要归还所有的本金
包括利息
就这么简单
算法并不是我们想象的那么难
是不是
所以说操作系统
他就是按照这个银行家制定的这种规则
进行分对进程进行分配资源啊
当进程它首次申请资源的时候啊
你需要什么来测试
那个进程对资源最大的需求量是多少
那如果系统这个线程资源可以满足这个需求
工最大需求
就按照当前这个量直接分配给他
否则你就推迟分配
就这么个意思啊
那么当这个进程呢他在执行当中
他继续申请什么申请资料时
那要先测试一下这个进程呢
本次申请的这个资源是否超过啊
超过你你那个资源所剩下的总量
超过就季节性分配这个职业
那如果啊能够满足的话呢
那就按照当前分配职业
否则的话就推迟分配银行
叫算法
就是这么做的啊
好那就给大家讲一个算法的原理
就给他整清楚了
是不是好
接下来我们就来看第二个点
第二个点是什么
第二个进十锁哎
死锁这个探测工具
死锁探测工具是什么意思呢
就是说LINUX内核他就提供什么
提供一些工具啊
来探索我们这个死锁
是不是就是说比如常用的啊
比如你这个常用的工具就说明什么呢
lock l o c k down这个
那么它可以什么呢
它可以在编译内核
它可以在编内核的时候就可以可以启动了
可以用它了
所以并且它能够检查那个潜在实属问题嗯
他可以查看的一清二楚
他他就这么个意思啊
另外一个
那么我们还知道什么
你还知道这个内核的配置选项
内核配置选项啊
那么大家肯定要设置两个点
那我们要设置哪两个点
就是说它提供一个内核配置选项的话
第一个就是config debug
configure下划线
debug里面什么lock lock是不是就是其中一个configure
第二个的话就是provide下划线啊
就是你通过这两个选项注意啊
就是通过
嗯通过增加内核
对于什么呢
对于所使用的一个什么使用的一个监视
监视和验证啊
这就是我们用这种方法是吧
这是第三个吗
验证
那第五个怎么做呢
第五个那就是很简单啊
就是工程师
那么就是分分分析一下日志嘛
对不对
分析日志
那你在哪里分析
就说当我们出现死锁的时候
那么你可以通过查看这个日志系统啊
就说明你查看这个查看这个系统日志
查看这个日子就可以
是不是在VR下面装了一个log
有个什么message在这个来查看
那么这个日志里面它就包含什么
包含有关于哪个县城呢
或者进程呢被阻塞的时候
会导致那个什么死锁的原因
总体来讲总体来讲对内核的死锁死锁检测
那么可以使用实时检测算法
就是银行家算法
也可以使用这个探测工具
也可以内核配置选项或者分析日志
来找到解决和定位这个问题在哪里
这是我们大家要考虑的啊
啊要考虑清楚的
索尼拉斯内核掩码分析
这节课是不是啊
微考试就全部啊都给大家讲完了
是不是
那么大家在学习的过程当中有任何问题
随时找我进行沟通与交流
那本节课就到此结束了
是不是哎咱们啊下一次课啊继续
那么在讲解这个之前
那我们在学内核的时候
我们要注意哪些问题呢
在这里面啊
我有这么几个问题
是不是有几百道的相关面试题
在这里就大家直接发给大家
大家有时间可以研究一下
如果你要研究什么
如果大家研究这个内存架构的话
你就按照内存架构这个啊
这个方法来处理的话就可以了
是不是
那如果你是要学这个内核调度算法
来显内核调度算法
内存管理
内存管理
你要学内存管理机
按这个来就行了
这里面我好像已经写好了
对着来就行了
这里面的每一个点看到没都给你写好了
该注释全部给你注释啊
怎么做
是不是就是内存管理
还有一个就是进程调度算法这一块
进程调度算法有关的
除了进程调度算法的话
还有相关的面试题
是不是100到LINUX内核面试题
你把这些全部收起来就可以收集起来好
那比如非常简单啊
你在内核
你看内核调试和性能调优这一块
那么如果在面试的时候
如果在面试过程中
那面试官也许会提到什么
也许会提到这么几个问题
大家可可以看一下是不是什么问题
比如我们这个36题
他问你什么
如何分析一个什么OOPS这个什么错误日志
那你怎么去分析这个错误的资料啊
OPS录制36题怎么去分析
他就这样的啊
就是说首先第一个问题
分析一个OPS错误日志
那你需要怎么做呢
第一个你要阅读那个错误的代码
错误信息是不是注意啊
你早做了
这个时候你要仔细阅读那个OPS的一个
错误的日志详细信息
比如错误的代码
还包括背上了
背上了跟踪这些信息
就可以找到那个错误发生位置
跟那个什么跟这个原因
所以说你分析的东西你不是分析一个点
是不是啊
不是一个点的
注意啊
不是一个点
是就是现在假设要你分析的话
你分析第一个到36题
是不是面试碰到这个问题
第二个的话呢
你还确定了一个什么
确定那个错误类型
错误类型呢你根据这个错误信息
我们可以定位到那个错误类型
比如内存访问问题还是空指针引用或者数组
业界是不是
那么你要缩小那个问题的一个什么范围啊
找到了一个精确定位啊
另外一个是什么呢
你要分析分析这个堆栈的一个跟踪
为什么呢
堆栈检查堆栈跟踪
要了解导致错误的一个函数调用顺序
因为你要查看什么
查看每个函数堆栈中的位置
确定那个函数的突出起点在哪里
是不是嗯
还有一个就是查看日志和数据了
查看日志数据的话
你比如系统日志
应用程序的输出或者输入数据
是不是这些信息所提供的上下文和帮它提示啊
对不对
还有一个是重现问题的
可问题是什么意思呢
就是重复出现是不是重复相关的
就是进一步的进行修复啊
还有一个就是使用潮湿工具GDBVLOG
是不是这两个
还有一个就是说你要提出这个问题
就是说啊参考一些相关的文档和资源
参考一般情况下家碰到问题
一般你作为开发人员碰到问题
是你碰到问题
首先第一个你是查看什么
你是查看相关的文档
第二个你才踩到那个什么
你才到开发者论坛去研究一下
看大家有没有碰到这样的错误
是不是
还有一个就是戳戳令堂也可以到什么
还可以到社区社区资源里面
对不对
你把问题丢过去开荒了
年有的碰到他就直接发给你了
对不对
非常简单嗯
这是至少啊至少你作为一个研发人员
你要具备这个能力
是不是你不去
那就没办法了
这这这就是一个点
是不是啊
那么就是说你比如啊
比如38题啊
内核中断管理机制
那我们怎么做呢
内核中的关系就是说发生什么呢
就是相当于我们LINUX内核对不对
他发生什么
发生这个硬件中断之后
那么有关于什么呢
比如arm64arm64处理器诶
他做他做什么呢
他是做哪些事情
那你怎么去分析这个问题
注意啊
当硬件发生啊
就是硬件怎么办嘛
2564处理器
当发现这个硬件中断
它就会执行什么呢
第一个就是硬件检测
为什么硬件检测呢
就是说他会检测那个啊
检测那个硬件中断信号
然后确定那个中断类型
这是一个方面
还有一个是中断处理程序的一个寻址方式
那么就是它会根据中断类型啊
检查那个中断向量表
找到那个这个中断出C的入口地址就可以了
还有一个就是中断上下网页保存
从头商用保存的话
那他做什么呢
就是啊就是arm64
他会将什么将当前被打断了进程或者县城啊
上下文啊
保存的内存或者是特定的数据结构里面去啊
这样做呢主要是保存当前进程的一个线程状态
以使得中断处理结束之后
我们还能够继续执行
还有一个就是第五点
就是你要执行什么执行中断福利层
中断福利成就说
你264
它会跳转到对应的一个什么中断处理程序
入口地址
开始执行相应的中断服务程序
那么这个操作
这个历程是由我们开发人员写的啊
比如处理一些特定类型硬件中断事件等等
一旦执行完毕
那arm64从保存上下文
他这个信息就会恢复到什么
恢复到导弹进程或者线程
并且重新启动他们就可以执行了
所以你要处理这个问题
OK好
那各位同学们啊啊各位朋友们
那么今天晚上内容我们就到此结束了
咱们下一次课啊再见

## 参考

[B站字幕转换 | 牧尘的NAS小站 (dreamlyn.cn)](https://www.dreamlyn.cn/html/bsrt.html)